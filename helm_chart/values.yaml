# Default values for permission-manager.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: quay.io/sighup/permission-manager
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: "1.8.0-rc1"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}

podSecurityContext:
  fsGroup: 2000

# Default values should not be used currently. It will result in a startup-error.
# TODO: correct default values should be placed here.
securityContext:
  {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

service:
  type: ClusterIP
  port: 80
  nodePort: null

#
# Ingress:
# - If you want to use a specific ingress controller, just uncomment "kubernetes.io/ingress.class" and type the name of your ingress class.
# - If you want to use TLS (https) for the web interface, just uncomment the "tls" part and add create the secret in the correct namespace.
# - If you're using cert-manager.io to provision your certificates, just uncomment "cert-manager.io/cluster-issuer" and type the name of your cluster-issuer. Please also uncomment the "tls" part with default values.
ingress:
  enabled: false
  annotations:
    # kubernetes.io/ingress.class: nginx
    # cert-manager.io/cluster-issuer: my-cluster-issuer
  hosts:
    - host: permission-manager.domain.com
      paths:
        - path: /
          pathType: ImplementationSpecific
  # tls:
  #   - secretName: permission-manager-tls
  #     hosts:
  #       - permission-manager.domain.com

#
# Ressources:
# The values already adjusted for a small permission-manager setup. Increase value if needed.
# It's recommended to use ressource limits, just uncomment and try out. To use autosacling, ressources are required.
resources:
  {}
  # Adjust lines as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 10m
  #   memory: 80Mi
  # requests:
  #   cpu: 10m
  #   memory: 80Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

#
# Application configuration:
config:
  # Can be found in /etc/kubernetes/admin.conf: clusters -> cluster -> name
  clusterName: "kind"

  # Can be found in /etc/kubernetes/admin.conf: clusters -> cluster -> server
  controlPlaneAddress: "https://127.0.0.1:61394"

  # Password for basic auth to access the UI
  basicAuthPassword: "pass"

  templates:
    - name: operation
      rules:
        - apiGroups:
            - "*"
          resources:
            - "*"
          verbs:
            - "*"

    - name: developer
      rules:
        - apiGroups:
            - "*"
          resources:
            - "configmaps"
            - "endpoints"
            - "persistentvolumeclaims"
            - "pods"
            - "pods/log"
            - "pods/portforward"
            - "podtemplates"
            - "replicationcontrollers"
            - "resourcequotas"
            - "secrets"
            - "services"
            - "events"
            - "daemonsets"
            - "deployments"
            - "replicasets"
            - "ingresses"
            - "networkpolicies"
            - "poddisruptionbudgets"
          verbs:
            - "*"

    - name: read-only
      rules:
        - apiGroups:
            - ""
          resources:
            - bindings
            - componentstatuses
            - configmaps
            - endpoints
            - events
            - limitranges
            - namespaces
            - namespaces/finalize
            - namespaces/status
            - nodes
            - nodes/proxy
            - nodes/status
            - persistentvolumeclaims
            - persistentvolumeclaims/status
            - persistentvolumes
            - persistentvolumes/status
            - pods
            - pods/attach
            - pods/binding
            - pods/eviction
            - pods/exec
            - pods/log
            - pods/proxy
            - pods/status
            - podtemplates
            - replicationcontrollers
            - replicationcontrollers/scale
            - replicationcontrollers/status
            - resourcequotas
            - resourcequotas/status
            - serviceaccounts
            - services
            - services/proxy
            - services/status
          verbs:
            - "get"
            - "list"
            - "watch"
        - apiGroups:
            - apps
          resources:
            - controllerrevisions
            - daemonsets
            - daemonsets/status
            - deployments
            - deployments/scale
            - deployments/status
            - replicasets
            - replicasets/scale
            - replicasets/status
            - statefulsets
            - statefulsets/scale
            - statefulsets/status
          verbs:
            - list
            - get
            - watch
        - apiGroups:
            - batch
          resources:
            - jobs
            - jobs/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - autoscaling
          resources:
            - horizontalpodautoscalers
            - horizontalpodautoscalers/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - storage.k8s.io
          resources:
            - csidrivers
            - csinodes
            - storageclasses
            - volumeattachments
            - volumeattachments/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - networking.k8s.io
          resources:
            - networkpolicies
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - scheduling.k8s.io
          resources:
            - priorityclasses
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - node.k8s.io
          resources:
            - runtimeclasses
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - extensions
          resources:
            - ingresses
            - ingresses/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - events.k8s.io
          resources:
            - events
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - apiextensions.k8s.io
          resources:
            - customresourcedefinitions
            - customresourcedefinitions/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - apiregistration.k8s.io
          resources:
            - apiservices
            - apiservices/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - discovery.k8s.io
          resources:
            - endpointslices
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - metrics.k8s.io
          resources:
            - pods
            - nodes
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - policy
          resources:
            - poddisruptionbudgets
            - poddisruptionbudgets/status
            - podsecuritypolicies
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - rbac.authorization.k8s.io
          resources:
            - clusterrolebindings
            - clusterroles
            - rolebindings
            - roles
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - "*"
          resources:
            - "componentstatuses"
            - "namespaces"
            - "nodes"
            - "persistentvolumes"
            - "mutatingwebhookconfigurations"
            - "validatingwebhookconfigurations"
            - "customresourcedefinitions"
            - "apiservices"
            - "tokenreviews"
            - "selfsubjectaccessreviews"
            - "selfsubjectrulesreviews"
            - "subjectaccessreviews"
            - "certificatesigningrequests"
            - "runtimeclasses"
            - "podsecuritypolicies"
            - "clusterrolebindings"
            - "clusterroles"
            - "priorityclasses"
            - "csidrivers"
            - "csinodes"
            - "storageclasses"
            - "volumeattachment"
          verbs:
            - "get"
            - "list"
            - "watch"

    - name: admin
      rules:
        - apiGroups:
            - ""
          resources:
            - bindings
            - componentstatuses
            - configmaps
            - endpoints
            - events
            - limitranges
            - namespaces
            - namespaces/finalize
            - namespaces/status
            - nodes
            - nodes/proxy
            - nodes/status
            - persistentvolumeclaims
            - persistentvolumeclaims/status
            - persistentvolumes
            - persistentvolumes/status
            - pods
            - pods/attach
            - pods/binding
            - pods/eviction
            - pods/exec
            - pods/log
            - pods/proxy
            - pods/status
            - podtemplates
            - replicationcontrollers
            - replicationcontrollers/scale
            - replicationcontrollers/status
            - resourcequotas
            - resourcequotas/status
            - serviceaccounts
            - services
            - services/proxy
            - services/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - apps
          resources:
            - controllerrevisions
            - daemonsets
            - daemonsets/status
            - deployments
            - deployments/scale
            - deployments/status
            - replicasets
            - replicasets/scale
            - replicasets/status
            - statefulsets
            - statefulsets/scale
            - statefulsets/status
          verbs:
            - list
            - get
            - watch
        - apiGroups:
            - batch
          resources:
            - jobs
            - jobs/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - autoscaling
          resources:
            - horizontalpodautoscalers
            - horizontalpodautoscalers/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - storage.k8s.io
          resources:
            - csidrivers
            - csinodes
            - storageclasses
            - volumeattachments
            - volumeattachments/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - networking.k8s.io
          resources:
            - networkpolicies
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - scheduling.k8s.io
          resources:
            - priorityclasses
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - node.k8s.io
          resources:
            - runtimeclasses
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - extensions
          resources:
            - ingresses
            - ingresses/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - events.k8s.io
          resources:
            - events
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - apiextensions.k8s.io
          resources:
            - customresourcedefinitions
            - customresourcedefinitions/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - apiregistration.k8s.io
          resources:
            - apiservices
            - apiservices/status
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - discovery.k8s.io
          resources:
            - endpointslices
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - metrics.k8s.io
          resources:
            - pods
            - nodes
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - policy
          resources:
            - poddisruptionbudgets
            - poddisruptionbudgets/status
            - podsecuritypolicies
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - rbac.authorization.k8s.io
          resources:
            - clusterrolebindings
            - clusterroles
            - rolebindings
            - roles
          verbs:
            - get
            - list
            - watch
        - apiGroups:
            - "*"
          resources:
            - "componentstatuses"
            - "namespaces"
            - "nodes"
            - "persistentvolumes"
            - "mutatingwebhookconfigurations"
            - "validatingwebhookconfigurations"
            - "customresourcedefinitions"
            - "apiservices"
            - "tokenreviews"
            - "selfsubjectaccessreviews"
            - "selfsubjectrulesreviews"
            - "subjectaccessreviews"
            - "certificatesigningrequests"
            - "runtimeclasses"
            - "podsecuritypolicies"
            - "clusterrolebindings"
            - "clusterroles"
            - "priorityclasses"
            - "csidrivers"
            - "csinodes"
            - "storageclasses"
            - "volumeattachment"
          verbs:
            - "*"
